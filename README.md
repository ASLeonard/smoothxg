# smoothxg

## local reconstruction of variation graphs using partial order alignment

Pangenome graphs built from raw sets of alignments may have complex local structures generated by common patterns of genome variation.
These local nonlinearities can introduce difficulty in downstream analyses, visualization, and interpretation of variation graphs.

`smoothxg` finds blocks of paths that are collinear within a variation graph.
It applies partial order alignment to each block, yielding an acyclic variation graph.
Then, to yield a "smoothed" graph, it walks the original paths to lace these subgraphs together.
The resulting graph only contains cyclic or inverting structures larger than the chosen block size, and is otherwise manifold linear.
In addition to providing a linear structure to the graph, `smoothxg` can be used to extract the consensus pangenome graph by applying the _heaviest bundle_ algorithm to each chain.

To find blocks, `smoothxg` applies a greedy algorithm that assumes that the graph nodes are sorted according to their occurence in the graph's embedded paths.
The path-guided stochastic gradient descent based 1D sort implemented in `odgi sort -Y` is designed to provide this kind of sort.

## building

`smoothxg` uses cmake to build itself and its dependencies. At least GCC V10.1 is required for compilation.

```
sudo apt-get update && sudo apt-get install -y libatomic-ops-dev libgsl-dev zlib1g-dev libzstd-dev

git clone --recursive https://github.com/pangenome/smoothxg.git
cd smoothxg
cmake -H. -Bbuild && cmake --build build -- -j 4
```

A `Bioconda` package of `smoothxg` can't be build, because `conda` comes with its own GCC V7.5. Altering that would 
result in unexpected behaviour for the whole environment. See https://github.com/bioconda/bioconda-recipes/pull/26189#issuecomment-767123749.